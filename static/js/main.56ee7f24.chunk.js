(this["webpackJsonpnear-blog"]=this["webpackJsonpnear-blog"]||[]).push([[0],{129:function(e,t,n){},131:function(e,t,n){},132:function(e,t,n){},133:function(e,t,n){},134:function(e,t,n){},135:function(e,t,n){},136:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n.n(c),r=n(64),s=n.n(r),i=(n(69),n(3)),l=n(7),o=n(6),j=n(2),u=n(16),d=Object({NODE_ENV:"production",PUBLIC_URL:"/near-blog",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).CONTRACT_NAME||"nblog.ibs.testnet";var b=function(e){switch(e){case"mainnet":return{networkId:"mainnet",nodeUrl:"https://rpc.mainnet.near.org",contractName:d,walletUrl:"https://wallet.near.org",helperUrl:"https://helper.mainnet.near.org",explorerUrl:"https://explorer.mainnet.near.org"};case"testnet":return{networkId:"testnet",nodeUrl:"https://rpc.testnet.near.org",contractName:d,walletUrl:"https://wallet.testnet.near.org",helperUrl:"https://helper.testnet.near.org",explorerUrl:"https://explorer.testnet.near.org"};default:throw Error("Unknown environment '".concat(e,"'."))}},O=n(28),h=n(23),p=b("testnet");function m(){return(m=Object(l.a)(Object(i.a)().mark((function e(){var t;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(O.connect)(Object.assign({deps:{keyStore:new O.keyStores.BrowserLocalStorageKeyStore}},p));case 2:t=e.sent,window.walletConnection=new O.WalletConnection(t),window.accountId=window.walletConnection.getAccountId(),window.contract=new O.Contract(window.walletConnection.account(),p.contractName,{viewMethods:["viewBlog","allBlogs"],changeMethods:["likeBlog","buyCoffee","createBlog"]});case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(){return x.apply(this,arguments)}function x(){return(x=Object(l.a)(Object(i.a)().mark((function e(){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=h.formatNearAmount,e.next=3,window.walletConnection.account().getAccountBalance();case 3:return e.t1=e.sent.total,e.abrupt("return",(0,e.t0)(e.t1,2));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}n(129);var v=n(0),f=function(){var e=window.walletConnection.account(),t=Object(c.useState)("0"),n=Object(o.a)(t,2),a=n[0],r=n[1],s=Object(j.f)(),d=Object(c.useCallback)(Object(l.a)(Object(i.a)().mark((function t(){return Object(i.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.accountId){t.next=6;break}return t.t0=r,t.next=4,w();case 4:t.t1=t.sent,(0,t.t0)(t.t1);case 6:case"end":return t.stop()}}),t)})))),b=function(){window.walletConnection.signOut(),window.location.reload(),s("/welcome")};return Object(c.useEffect)((function(){d()}),[d]),Object(v.jsx)(v.Fragment,{children:Object(v.jsxs)("div",{className:"app__nav",children:[Object(v.jsx)("div",{className:"nav-logo",children:"NBlog"}),Object(v.jsxs)("div",{className:"nav-links",children:[Object(v.jsx)(u.b,{className:"nav-link",to:"/",children:"Home"}),Object(v.jsx)(u.b,{className:"nav-link",to:"/write",children:"Write"})]}),Object(v.jsxs)("div",{className:"nav-end",children:[Object(v.jsxs)("div",{className:"nav-end--profile",children:[window.accountId," | ",a," NEAR"]}),Object(v.jsx)("div",{className:"nav-end--logout",onClick:function(){return b()},children:"Logout"})]})]})})},g=(n(131),n.p+"static/media/like-img.39933f53.png"),N=(n(132),n(133),1e14);function k(e){return window.contract.likeBlog({slug:e})}function C(e,t){return S.apply(this,arguments)}function S(){return(S=Object(l.a)(Object(i.a)().mark((function e(t,n){var c;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=Object(h.parseNearAmount)(n+""),e.next=3,window.contract.buyCoffee({slug:t},N,c);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return _.apply(this,arguments)}function _(){return(_=Object(l.a)(Object(i.a)().mark((function e(t){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.contract.viewBlog({slug:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var B=n(33),E=function(){var e=Object(c.useState)(1),t=Object(o.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(),s=Object(o.a)(r,2),u=s[0],d=s[1],b=Object(j.g)().slug,O=function(){var e=Object(l.a)(Object(i.a)().mark((function e(){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k(b);case 3:window.location.reload(),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log({e:e.t0});case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),h=function(){var e=Object(l.a)(Object(i.a)().mark((function e(){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C(b,n).then((function(){return alert("Successfully tipped author")}));case 2:case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),p=Object(c.useCallback)(Object(l.a)(Object(i.a)().mark((function e(){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=d,e.next=4,y(b);case 4:e.t1=e.sent,(0,e.t0)(e.t1),e.next=11;break;case 8:e.prev=8,e.t2=e.catch(0),console.log({e:e.t2});case 11:case"end":return e.stop()}}),e,null,[[0,8]])}))));return Object(c.useEffect)((function(){p()}),[]),Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(f,{}),u?Object(v.jsx)("div",{className:"app__details",children:Object(v.jsxs)("div",{className:"details",children:[Object(v.jsx)("img",{src:u.thumbnail}),Object(v.jsxs)("div",{className:"details-meta-0",children:[Object(v.jsxs)("div",{className:"details-meta-1",children:[Object(v.jsx)("div",{className:"details-dp",children:new Date(u.datePublished/1e6).toLocaleString()}),Object(v.jsxs)("div",{className:"details-rt",children:[Object(B.readingTime)(u.content).minutes," mins read"]})]}),Object(v.jsxs)("div",{className:"details-author",children:["by ",Object(v.jsx)("span",{children:u.author})]})]}),Object(v.jsx)("div",{className:"details-title",children:u.title}),Object(v.jsx)("div",{className:"details-details",children:u.content}),Object(v.jsx)("hr",{}),Object(v.jsxs)("div",{className:"details-lc",children:[Object(v.jsxs)("div",{className:"details-lc-1",onClick:function(){return O()},children:[Object(v.jsx)("img",{src:g}),Object(v.jsx)("div",{children:u.likes.length})]}),Object(v.jsxs)("div",{className:"details-lc-2",children:[Object(v.jsxs)("span",{onClick:function(){return h()},children:["Buy author ",n," coffee"]}),Object(v.jsx)("input",{defaultValue:1,min:1,value:n,onChange:function(e){return a(e.target.value)}})]})]})]})}):Object(v.jsx)("div",{children:"Loading..."})]})},T=n(138),U=(n(134),function(){var e=a.a.useState(),t=Object(o.a)(e,2),n=t[0],r=t[1],s=Object(c.useState)(),u=Object(o.a)(s,2),d=u[0],b=u[1],O=Object(c.useState)(),h=Object(o.a)(O,2),p=h[0],m=h[1],w=Object(j.f)(),x=function(){var e=Object(l.a)(Object(i.a)().mark((function e(){var t,c,a;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object(T.a)(),c="".concat((s=d,s.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"")),"-").concat(t),a={id:t,slug:c,title:d,content:p,thumbnail:n},e.next=5,(r=a,window.contract.createBlog({blogData:r})).then((function(){w("/"),alert("Successfully created new blog")}));case 5:case"end":return e.stop()}var r,s}),e)})));return function(){return e.apply(this,arguments)}}();return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(f,{}),Object(v.jsx)("div",{className:"app__write",children:Object(v.jsxs)("div",{className:"write",children:[Object(v.jsxs)("div",{className:"write-header",children:[Object(v.jsx)("img",{src:n,alt:"thumbnail image"}),Object(v.jsx)("input",{value:n,onChange:function(e){return r(e.target.value)},placeholder:"Enter thumbnail URL here"})]}),Object(v.jsxs)("div",{className:"write-edit",children:[Object(v.jsx)("input",{className:"write-title",placeholder:"Blog title here",value:d,onChange:function(e){return b(e.target.value)}}),Object(v.jsx)("textarea",{className:"write-content",placeholder:"Blog content here",value:p,onChange:function(e){return m(e.target.value)}})]}),Object(v.jsx)("button",{className:"publish-btn",onClick:function(){return x()},children:"Publish"})]})})]})}),I=(n(135),function(){return Object(v.jsxs)("div",{className:"app__welcome",children:[Object(v.jsxs)("div",{className:"welcome-title",children:["Welcome to ",Object(v.jsx)("span",{children:"Near Blog"})]}),Object(v.jsx)("div",{className:"welcome-sub",children:"The leading decentralised blogging platform"}),Object(v.jsx)("img",{src:"https://picsum.photos/500/500"}),Object(v.jsxs)("div",{className:"welcome-text",children:["You need to ",Object(v.jsx)("span",{onClick:function(){window.walletConnection.requestSignIn(p.contractName)},children:"log in"})," to continue"]})]})}),A=function(){var e=window.walletConnection.account(),t=Object(c.useState)(!1),n=Object(o.a)(t,2),a=n[0],r=n[1],s=Object(c.useState)([]),j=Object(o.a)(s,2),d=j[0],b=j[1],O=Object(c.useCallback)(Object(l.a)(Object(i.a)().mark((function e(){return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r(!0),e.t0=b,e.next=5,window.contract.allBlogs();case 5:e.t1=e.sent,(0,e.t0)(e.t1),e.next=12;break;case 9:e.prev=9,e.t2=e.catch(0),console.log({e:e.t2});case 12:return e.prev=12,r(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[0,9,12,15]])}))));return Object(c.useEffect)((function(){O()}),[]),Object(v.jsx)(v.Fragment,{children:e.accountId?Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(f,{}),Object(v.jsxs)("div",{className:"app__app",children:[Object(v.jsx)("div",{className:"app-heading",children:"Recent Blogs"}),a?Object(v.jsx)("div",{children:"Loading..."}):Object(v.jsx)("div",{className:"app-body",children:d.map((function(e){return Object(v.jsxs)("div",{className:"preview",children:[Object(v.jsx)("img",{src:e.thumbnail}),Object(v.jsxs)("div",{className:"preview-meta-0",children:[Object(v.jsxs)("div",{className:"preview-meta-1",children:[Object(v.jsx)("div",{className:"preview-dp",children:new Date(e.datePublished/1e6).toDateString()}),Object(v.jsxs)("div",{className:"preview-rt",children:[Object(B.readingTime)(e.content).minutes," mins read"]})]}),Object(v.jsxs)("div",{className:"preview-author",children:["by ",Object(v.jsx)("span",{children:e.author})]})]}),Object(v.jsx)("div",{className:"preview-title",children:Object(v.jsx)(u.b,{to:"/blog/".concat(e.slug),children:e.title})}),Object(v.jsx)("div",{className:"preview-preview",children:e.content}),Object(v.jsx)("hr",{}),Object(v.jsxs)("div",{className:"preview-lc",children:[Object(v.jsx)("img",{src:g}),Object(v.jsx)("div",{children:e.likes.length})]})]})}))})]})]}):Object(v.jsx)(I,{})})};window.nearInitPromise=function(){return m.apply(this,arguments)}().then((function(){s.a.render(Object(v.jsx)(a.a.StrictMode,{children:Object(v.jsx)(u.a,{children:Object(v.jsxs)(j.c,{children:[Object(v.jsx)(j.a,{path:"/",element:Object(v.jsx)(A,{})}),Object(v.jsx)(j.a,{path:"/write",element:Object(v.jsx)(U,{})}),Object(v.jsx)(j.a,{path:"/welcome",element:Object(v.jsx)(I,{})}),Object(v.jsx)(j.a,{path:"/blog/:slug",element:Object(v.jsx)(E,{})})]})})}),document.getElementById("root"))})).catch(console.error)},69:function(e,t,n){},74:function(e,t){},84:function(e,t){}},[[136,1,2]]]);
//# sourceMappingURL=main.56ee7f24.chunk.js.map